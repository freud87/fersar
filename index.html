<!DOCTYPE html>
<html lang="fr">
	<head>
  		<meta charset="UTF-8">
		<title>Sarra & Ferid</title>
		<link href="fersar.png" rel="icon" type="image/x-icon" />
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
		<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
		<style>
			* {
				color:#212E53;
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body, html {
				height: 100%;
				font-family: 'Segoe UI', sans-serif;
			}
			body {
				display: grid;
				grid-template-rows: auto 1fr;
				grid-template-columns: 250px 1fr;
				grid-template-areas:
				"header header"
				"sidebar main";
				background: #fff0f5;
			}
			header {
				grid-area: header;
				background: #EBACA2;
				color: white;
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 5px 10px;
				font-size: 1.5em;
			}
			.headerG {
				display: flex;
				align-items: center;
			}
				.titre{
				margin-left: 5px;
			}
			.countdown {
				background: #BED3C3;
				color: #333;
				padding: 0.5em 1em;
				border: 2px dashed #ff69b4;
				border-radius: 10px;
				font-size: 1em;
			}
			.sidebar {
				grid-area: sidebar;
				background-color: #ffb6c1;
				display: flex;
				flex-direction: column;
				padding: 1em;
			}
			.sidebar button {
				background: none;
				border: none;
				padding: 8px 5px;
				text-align: left;
				font-size: 1em;
				cursor: pointer;
			}
			.sidebar button:hover {
				background-color: #ff69b4;
			}
			main {
				grid-area: main;
				padding: 1em;
				overflow: hidden;
				position: relative;
				background-color: #BED3C3;
			}
			.slider-section {
				display: none;
				position: relative;
				height: 100%;
			}
			.slider-section.active {
				display: block;
			}
			.slides {
				display: flex;
				transition: transform 0.5s ease;
				height: 100%;
				width: 100%;
			}
			.slides img {
				width: 100%;
				height: 100%;
				object-fit: contain;
				flex-shrink: 0;
			}
			#map {
				width: 100%;
				height: 100%;
			}
			.tableicons {
				display: flex;
				flex-direction: row;
			}
			#sauver { display: none; }
			.nav-button {
				position: absolute;
				top: 50%;
				transform: translateY(-50%);
				border: none;
				font-size: 2em;
				/*padding: 0.2em 0.5em;*/
				cursor: pointer;
				/*border-radius: 50%;*/
				user-select: none;
			}
			.nav-button:hover {
				background: #ff69b4;
				color: white;
			}
			.prev {
				left: 10px;
			}
			.next {
				right: 10px;
			}
			.save-warning {
				color: red;
				display: none;
				font-weight: bold;
				margin: 10px 0;
			}
			table {
				border-collapse: collapse;
				width: 100%;
				margin-top: 10px;
			}
			th, td {
				border: 1px solid #999;
				padding: 6px;
			}
			input[type="text"] {
				width: 100%;
				box-sizing: border-box;
			}
			.countdown-group {
				display: none;
				background: #fff;
				color: #333;
				font-size: 1em;
				margin: 10px auto;
				padding: 0.5em 1.5em;
				border: 2px dashed #ff69b4;
				border-radius: 10px;
				width: fit-content;
			}
			@media (max-width: 1080px) {
				body {
					display: flex;
					flex-direction: column;
				}
				.sidebar {
					flex-direction: row;
					justify-content: space-around;
					width: 100%;
					padding: 0.5em;
					font-size: 2em;
				}
				.sidebar button {
					/*flex: 1;*/
					text-align: center;
					Width: auto;
				}
				main {
					flex: 1 1 auto; /* Ici, main prend tout l'espace restant */
					padding: 1em;
					margin-bottom:10px;
				}
				.countdown {
					display: none;
				}
				.countdown-group {
					display: flex;
					flex-direction: row;
					justify-content: space-between;
					align-items: center;
					margin-top: auto;
				}
				#mobhour {
					font-size: 100px;
					display: block;
					margin: auto;
					transition: transform 0.6s ease-in-out;
				}
			}
		</style>
	</head>
	<body>
		<header>
			<div class="headerG">
				<img src="fersar.png" alt="fersarlogo" loading="lazy">
				<div class="titre">Sarra & Ferid</div>
			</div>
			<div class="active"></div>
			<div class="countdown" id="countdown">Chargement‚Ä¶</div>
		</header>
		<div class="sidebar">
			<button data-section="section1" onclick="showSection(this)">Duo</button>
			<button data-section="section2" onclick="showSection(this)">Souvenirs</button>
			<button data-section="section3" onclick="showSection(this)">Fian√ßailles</button>
			<button data-section="section4" onclick="showSection(this)">Ghibli</button>
			<button data-section="sectionMap" onclick="showSection(this)">Cartes</button>
			<button data-section="Pr√©paratifs" onclick="showSection(this)">Pr√©paratifs</button>
		</div>
	<main>
		<section id="section1" class="slider-section active">
			<div class="slides">
				<img src="duo.rdv.01052025.jpeg" alt="duo.rdv.01052025" loading="lazy">
				<img src="duo.rdv.17042025.jpeg" alt="duo.rdv.17042025" loading="lazy">
				<img src="duo.rdv.24102024.jpg" alt="duo.rdv.24102024" loading="lazy">
			</div>   
		</section>
		<section id="section2" class="slider-section">
			<div class="slides">
				<img src="souvenirs.05052024.jpg" alt="souvenirs.msg.001" loading="lazy">
				<img src="souvenirs.01052025.jpg" alt="souvenirs.drole.001" loading="lazy">
			</div>
		</section>
		<section id="section3" class="slider-section">
			<div class="slides">
				<img src="fian√ßailles.gold.001.jpg" alt="fian√ßailles.gold.001" loading="lazy">
				<img src="fian√ßailles.gold.002.jpg" alt="fian√ßailles.gold.002" loading="lazy">
				<img src="fian√ßailles.gold.003.jpg" alt="fian√ßailles.gold.003" loading="lazy">
				<img src="fian√ßailles.gold.004.jpg" alt="fian√ßailles.gold.004" loading="lazy">
			</div>
		</section>
		<section id="section4" class="slider-section">
			<div class="slides">
				<img src="duo.ghibli.001.webp" alt="duo.ghibli.001" loading="lazy">
				<img src="duo.ghibli.002.webp" alt="duo.ghibli.002" loading="lazy">
				<img src="duo.ghibli.003.jpg" alt="duo.ghibli.003" loading="lazy">
			</div>
		</section>
		<section id="sectionMap" class="slider-section">
			<div id="map"></div>
		</section>
		<section id="Pr√©paratifs" class="slider-section">
			<div class="tableicons">
				<button id="addRowBtn"><i class="bi bi-plus-square"></i> Ajouter une ligne</button>
				<button id="saveBtn"><i class="bi bi-floppy"></i> Enregistrer</button>
				<p class="save-warning" id="saveWarning"><i class="bi bi-exclamation-triangle"></i> Vous devez sauvegarder les modifications.</p>
			</div>
			<div id="tableContainer"></div>
		</section>
		<button class="nav-button prev" onclick="prevSlide()">
			<i class="bi bi-arrow-left-circle-fill"></i>
		</button>
		<button class="nav-button next" onclick="nextSlide()">
			<i class="bi bi-arrow-right-circle-fill"></i>
		</button>
	</main>
		<div class="countdown-group">
			<i id="mobhour" class="bi bi-hourglass-split"></i>
			<div class="countdown-mobile" id="countdown-mobile"></div>
		</div>
<script>
  let currentIndex = 0;
  let mapInitialized = false;

  function showSection(button) {
    const sectionId = button.getAttribute("data-section");
    const sectionName = button.textContent.trim();

    document.querySelectorAll('.slider-section').forEach(section => {
      section.classList.remove('active');
    });

    const activeSection = document.getElementById(sectionId);
    activeSection.classList.add('active');

    document.querySelector('header .active').innerHTML = `<strong>${sectionName}</strong>`;

    currentIndex = 0;
    updateSlide();

    // Charger la carte si c'est la section "Cartes"
    if (sectionId === "sectionMap" && !mapInitialized) {
      initLeafletMap();
      mapInitialized = true;
    }

    // Charger le tableau si c'est la section "Pr√©paratifs"
    if (sectionId === "Pr√©paratifs" && !activeSection.dataset.loaded) {
      activeSection.dataset.loaded = "true"; // Marquer comme charg√©

      // Si la fonction loadTableFromSheet existe, on l'appelle
      if (typeof loadTableFromSheet === 'function') {
        loadTableFromSheet();
      } else {
        console.warn("Fonction loadTableFromSheet non trouv√©e. V√©rifiez pr√©paratifs.js.");
        alert("Erreur : Impossible de charger le tableau. V√©rifiez que pr√©paratifs.js est bien charg√©.");
      }
    }
  }

  function updateSlide() {
    const activeSlides = document.querySelector('.slider-section.active .slides');
    if (!activeSlides) return;
    activeSlides.style.transform = `translateX(-${currentIndex * 100}%)`;
  }

  function nextSlide() {
    const activeSlides = document.querySelector('.slider-section.active .slides');
    if (!activeSlides) return;
    const totalSlides = activeSlides.children.length;
    currentIndex = (currentIndex + 1) % totalSlides;
    updateSlide();
  }

  function prevSlide() {
    const activeSlides = document.querySelector('.slider-section.active .slides');
    if (!activeSlides) return;
    const totalSlides = activeSlides.children.length;
    currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
    updateSlide();
  }

  const countdownEl = document.getElementById("countdown");
  const countdownMobileEl = document.getElementById("countdown-mobile");
  const weddingDate = new Date("2026-07-04T21:00:00").getTime();

  function updateCountdown() {
    const now = new Date().getTime();
    const distance = weddingDate - now;

    if (distance < 0) {
      countdownEl.innerHTML = "üéâ C'est le grand jour ! üéä";
      countdownMobileEl.innerHTML = "üéâ C'est le grand jour ! üéä";
      return;
    }

    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((distance % (1000 * 60)) / 1000);

    const formattedHours = String(hours).padStart(2, '0');
    const formattedMinutes = String(minutes).padStart(2, '0');
    const formattedSeconds = String(seconds).padStart(2, '0');

    countdownEl.innerHTML = `<i class="bi bi-hourglass-split"></i> ${days}j ${formattedHours}h ${formattedMinutes}m ${formattedSeconds}s`;
    countdownMobileEl.innerHTML = `
      ${days} jours<br>
      ${formattedHours} heures<br>
      ${formattedMinutes} minutes<br>
      ${formattedSeconds} secondes`;
  }

  setInterval(updateCountdown, 1000);
  updateCountdown();

  document.querySelector('header .active').innerHTML = `<strong>Duo</strong>`;

  function initLeafletMap() {
    const map = L.map('map').setView([36.1596653, 9.2668632], 12);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright " target="_blank">OpenStreetMap</a> contributors',
      maxZoom: 19
    }).addTo(map);

    var sarraIcon = L.icon({
      iconUrl: 'icone.sarra.pt.png',
      iconSize: [40, 40],
      iconAnchor: [16, 32],
      popupAnchor: [0, -32]
    });

    var feridIcon = L.icon({
      iconUrl: 'icone.ferid.pt.png',
      iconSize: [40, 40],
      iconAnchor: [16, 32],
      popupAnchor: [0, -32]
    });

    var mariageIcon = L.icon({
      iconUrl: 'duo.heart.png',
      iconSize: [60, 60],
      iconAnchor: [16, 32],
      popupAnchor: [0, -32]
    });

    L.marker([36.097083, 9.383750], { icon: sarraIcon }).addTo(map)
      .bindPopup("<div style='background-color: #FFC0CB; padding: 5px; border-radius: 5px;'><b>Sarra la mari√©e</b></div>");

    L.marker([36.234494, 9.200618], { icon: feridIcon }).addTo(map)
      .bindPopup("<div style='background-color: #FFC0CB; padding: 5px; border-radius: 5px;'><b>Ferid le mari√©</b></div>");

    L.marker([36.087528, 9.373667], { icon: mariageIcon }).addTo(map)
      .bindPopup("<div style='background-color: #90EE90; padding: 5px;'><b>Salle des f√™tes HANNIBAL</b></div>");
  }

  let flipped = false;
  const icon = document.getElementById("mobhour");

  setInterval(() => {
    flipped = !flipped;
    icon.style.transform = flipped ? 'scaleY(-1)' : 'scaleY(1)';
  }, 5000);
</script>

<!-- Chargement du script externe pour le tableau -->
<script src="pr√©paratifs.js"></script>
	</body>
</html>
